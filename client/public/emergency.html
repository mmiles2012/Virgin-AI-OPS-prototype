<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AINO - Emergency Interface</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .container {
            padding: 20px;
            max-width: 100%;
            overflow-y: auto;
            min-height: 100vh;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
        }
        .header h1 {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .header p {
            color: #bfdbfe;
            font-size: 16px;
        }
        .tabs {
            display: flex;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
            white-space: nowrap;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            background: transparent;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            min-width: 120px;
        }
        .tab.active {
            background: #3b82f6;
            color: white;
            border-radius: 6px;
        }
        .content {
            display: none;
        }
        .content.active {
            display: block;
        }
        .card {
            background: rgba(0,0,0,0.4);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .card h2 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #60a5fa;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .status-label {
            color: #d1d5db;
            font-size: 14px;
        }
        .status-value {
            color: #10b981;
            font-weight: bold;
            font-size: 14px;
        }
        .flight-item {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
        }
        .flight-number {
            font-size: 16px;
            font-weight: bold;
            color: white;
            margin-bottom: 4px;
        }
        .flight-details {
            font-size: 13px;
            color: #d1d5db;
            margin-bottom: 4px;
        }
        .flight-tech {
            font-size: 11px;
            color: #9ca3af;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #9ca3af;
        }
        .refresh-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 20px;
            width: 100%;
        }
        .refresh-btn:hover {
            background: #2563eb;
        }
        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            color: #fca5a5;
        }
        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
            }
            .tab {
                flex: none;
                min-width: 90px;
                padding: 12px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>AINO</h1>
            <p>Aviation Intelligence Platform - Emergency Interface</p>
            <p style="font-size: 12px; color: #9ca3af; margin-top: 5px;">
                Replit App Compatible ‚Ä¢ Live Data Active
            </p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">Overview</button>
            <button class="tab" onclick="showTab('flights')">Live Flights</button>
            <button class="tab" onclick="showTab('fleet')">Fleet</button>
            <button class="tab" onclick="showTab('weather')">Weather</button>
            <button class="tab" onclick="showTab('operations')">Operations</button>
        </div>

        <div id="overview" class="content active">
            <div class="card">
                <h2>üéØ Live Operations Status</h2>
                <div class="status-item">
                    <span class="status-label">Virgin Atlantic Fleet</span>
                    <span class="status-value" id="fleetCount">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Data Source</span>
                    <span class="status-value">ADS-B Exchange Live</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Last Update</span>
                    <span class="status-value" id="lastUpdate">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">System Status</span>
                    <span class="status-value">All Systems Operational</span>
                </div>
            </div>
        </div>

        <div id="flights" class="content">
            <div class="card">
                <h2>‚úàÔ∏è Live Virgin Atlantic Flights</h2>
                <div id="flightsList">
                    <div class="loading">Loading authentic flight data...</div>
                </div>
                <button class="refresh-btn" onclick="loadFlights()">Refresh Flight Data</button>
            </div>
        </div>

        <div id="fleet" class="content">
            <div class="card">
                <h2>üõ©Ô∏è Fleet Overview</h2>
                <div class="status-item">
                    <span class="status-label">Total Aircraft</span>
                    <span class="status-value">43</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Currently Airborne</span>
                    <span class="status-value" id="airborneCount">Loading...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Aircraft Types</span>
                    <span class="status-value">B789, A35K, A333</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Authentic Tracking</span>
                    <span class="status-value">ADS-B Exchange</span>
                </div>
            </div>
        </div>

        <div id="weather" class="content">
            <div class="card">
                <h2>üå§Ô∏è Weather Intelligence</h2>
                <div class="status-item">
                    <span class="status-label">AVWX API</span>
                    <span class="status-value">Connected</span>
                </div>
                <div class="status-item">
                    <span class="status-label">SIGMET Monitoring</span>
                    <span class="status-value">Active</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Weather Radar</span>
                    <span class="status-value">Global Coverage</span>
                </div>
                <div class="status-item">
                    <span class="status-label">METAR Updates</span>
                    <span class="status-value">30-minute cycles</span>
                </div>
            </div>
        </div>

        <div id="operations" class="content">
            <div class="card">
                <h2>üéõÔ∏è Operations Center</h2>
                <div class="status-item">
                    <span class="status-label">ML Delay Prediction</span>
                    <span class="status-value">Active</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Connection Management</span>
                    <span class="status-value">Heathrow T3</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Digital Twins</span>
                    <span class="status-value">Boeing 787 & Airbus</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Corruption Detection</span>
                    <span class="status-value">VIR58N‚ÜíVIR158, VIR36VL‚ÜíVIR136</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let flightData = [];

        function showTab(tabName) {
            // Hide all content
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        async function loadFlights() {
            try {
                const response = await fetch('/api/aviation/virgin-atlantic-flights');
                const data = await response.json();
                
                if (data.success && data.flights) {
                    flightData = data.flights;
                    displayFlights(flightData);
                    updateCounts();
                    updateLastUpdate();
                } else {
                    showError('Failed to load flight data');
                }
            } catch (error) {
                console.error('Error loading flights:', error);
                showError('Network error loading flights');
            }
        }

        function displayFlights(flights) {
            const flightsList = document.getElementById('flightsList');
            
            if (flights.length === 0) {
                flightsList.innerHTML = '<div class="loading">No flights currently tracked</div>';
                return;
            }

            flightsList.innerHTML = flights.slice(0, 8).map(flight => `
                <div class="flight-item">
                    <div class="flight-number">${flight.flight_number} ‚Ä¢ ${flight.route}</div>
                    <div class="flight-details">${flight.aircraft_type} ‚Ä¢ ${flight.registration} ‚Ä¢ ${flight.status}</div>
                    <div class="flight-tech">Alt: ${flight.altitude}ft ‚Ä¢ Speed: ${flight.velocity || 'N/A'}kts ‚Ä¢ ${flight.data_source}</div>
                </div>
            `).join('');
        }

        function updateCounts() {
            document.getElementById('fleetCount').textContent = `${flightData.length} Flights Tracked`;
            document.getElementById('airborneCount').textContent = flightData.length;
        }

        function updateLastUpdate() {
            const now = new Date().toLocaleTimeString();
            document.getElementById('lastUpdate').textContent = now;
        }

        function showError(message) {
            const flightsList = document.getElementById('flightsList');
            flightsList.innerHTML = `<div class="error">Error: ${message}</div>`;
        }

        // Initial load
        loadFlights();
        
        // Auto-refresh every 30 seconds
        setInterval(loadFlights, 30000);
    </script>
</body>
</html>